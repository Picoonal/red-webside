import{F as G,L as k,C as I,P as O,_ as T,b as U,c as V,G as D,a as J}from"./comp-libs-kaq5mMGe.js";import{u as M}from"./useRequestList-zzeLWAwj.js";/* empty css              */import{a6 as R,d as w,w as W,e as E,U as H,i as j,r as y,h as b,l as f,M as L,_ as e,u as i,J as A,K,F as N,N as z,B as g,f as _,p as Q}from"./vue-vendor-13TjpPhz.js";import{g as X,e as Y,a as Z,c as ee,b as te}from"./api-libs-B_1UTR2a.js";import{d as oe}from"../assets/index-6d5tK8-d.js";import{g as ne,M as S}from"./comp-vendor-Va0SXYoc.js";import{u as ae}from"./locale-vendor-LTacbNcc.js";function se(v,s,o=1e3*60){const c=document.createElement("div");document.body.appendChild(c),R(w(()=>{const{data:l,run:r,cancel:C}=oe(X,{pollingInterval:o,pollingWhenHidden:!0,pollingWhenOffline:!0,manual:!0}),h=W(l,()=>{var p;((p=l.value)==null?void 0:p.code)=="0"&&(Y.emit("message:noteGenerateSuccess",v),C(),c.remove())});return r({id:s}),E(()=>{console.log("unmounted polling"),h()}),()=>H(v.name)})).mount(c)}const ie={class:"commodity-page flex flex-col h-full"},le={class:"layout-title"},re={class:"commodity-list flex-1 relative"},me=w({__name:"commodity",setup(v){const{t:s}=ae(),o=j("emitter"),c=y(["123","234"]),u=y(!1),l=y(!1),r=y({}),{list:C,loading:h,total:p,queryParams:m,forceUpdate:B}=M(Z);function $(a){const{searchText:t,filterCondition:d}=a;let n=!1;m.query!=t&&(m.query=t,n=!0),m.queryType!=d&&(m.queryType=d,n=!0),n&&(m.current=1)}function q(){u.value=!0}function x(a){console.log("commodityData",a),o==null||o.emit("fullScreenLoading:show"),ee(a).then(()=>{u.value=!1,o==null||o.emit("fullScreenLoading:hide"),S.success(s("commodity.response.createCommoditySuccess")),B()})}function F(a){r.value=a,l.value=!0}function P(a){console.log("noteData",a),o==null||o.emit("fullScreenLoading:show"),te({...a,commodityBrand:r.value.brand,commodityId:r.value.id}).then(t=>{l.value=!1,o==null||o.emit("fullScreenLoading:hide"),S.info(s("commodity.response.generateNoteInfo")),se(JSON.parse(JSON.stringify(r.value)),t.data.id)})}return(a,t)=>{const d=ne;return _(),b(N,null,[f("section",ie,[f("section",le,[f("span",null,L(e(s)("commodity.title")),1)]),i(e(G),{onChange:$,placeholder:e(s)("commodity.searchPlaceHolder"),filterConditionList:c.value},null,8,["placeholder","filterConditionList"]),f("section",re,[A(i(e(k),{"blur-bg":!0},null,512),[[K,e(h)]]),(_(!0),b(N,null,z(e(C),n=>(_(),Q(e(I),{key:n.id,"commodity-info":n,onCreateNote:F},null,8,["commodity-info"]))),128))]),i(e(U),{"current-page":e(m).current,"onUpdate:currentPage":t[0]||(t[0]=n=>e(m).current=n),total:e(p)},{left:g(()=>[i(e(O),{onClick:q},{default:g(()=>[i(e(T),{name:"plus"}),f("span",null,L(e(s)("commodity.createCommodityBtn")),1)]),_:1})]),_:1},8,["current-page","total"])]),i(d,{visible:u.value,footer:!1,placement:"right",unmountOnClose:"",title:e(s)("commodity.formTitle.createCommodity"),onCancel:t[2]||(t[2]=n=>u.value=!1)},{default:g(()=>[i(e(V),{onSubmit:x,onCancel:t[1]||(t[1]=n=>u.value=!1)})]),_:1},8,["visible","title"]),i(d,{visible:l.value,footer:!1,placement:"right",unmountOnClose:"",title:e(s)("commodity.formTitle.generateNote"),onCancel:t[4]||(t[4]=n=>l.value=!1)},{default:g(()=>[i(e(D),{"commodity-info":r.value,onSubmit:P,onCancel:t[3]||(t[3]=n=>l.value=!1)},null,8,["commodity-info"])]),_:1},8,["visible","title"])],64)}}}),Ce=J(me,[["__scopeId","data-v-da765980"]]);export{Ce as default};

import{F as k,L as E,C as I,P as O,_ as J,b as V,E as D,G,a as M}from"./comp-libs-hM04ODlz.js";import{u as H}from"./useRequestList-vfP09r0x.js";import{d as R}from"../assets/index-E8y6VTV3.js";import{d as U,i as j,r as c,h,l as f,M as S,$ as t,u as l,J as z,K,F as _,N as A,B as y,f as v,p as Q}from"./vue-vendor-Ewu5EBAq.js";import{b as W,d as X,f as Y,h as Z,i as ee}from"./api-libs-1XXty04u.js";import{h as oe,M as C}from"./comp-vendor-oDlW8gRb.js";import{u as te}from"./locale-vendor-npigJYsg.js";const ie={class:"commodity-page flex flex-col h-full"},ne={class:"layout-title"},ae={class:"commodity-list flex-1 z-0"},se=U({__name:"commodity",setup(le){const{t:a}=te(),e=j("emitter"),b=c(["commodity.id","commodity.name","commodity.brand"]),r=c(!1),d=c(!1),m=c({}),p=c(a("commodity.formTitle.createCommodity")),{list:L,loading:N,total:w,queryParams:s,forceUpdate:g}=H(W);function B(i){const{searchText:o,filterCondition:u}=i;let n=!1;s.query!=o&&(s.query=o,n=!0),s.queryType!=u&&(s.queryType=u,n=!0),n&&(s.current=1)}function F(){p.value=a("commodity.formTitle.createCommodity"),m.value={},r.value=!0}function x(i,o){if(e==null||e.emit("fullScreenLoading:show"),o)return X(i).then(()=>{r.value=!1,e==null||e.emit("fullScreenLoading:hide"),C.success(a("commodity.response.changeCommoditySuccess")),g(s.current)});console.log("commodityData",i),Y(i).then(()=>{r.value=!1,e==null||e.emit("fullScreenLoading:hide"),C.success(a("commodity.response.createCommoditySuccess")),g()})}function T(i){e==null||e.emit("fullScreenLoading:show"),Z({id:i.id}).then(()=>{e==null||e.emit("fullScreenLoading:hide"),C.success(a("commodity.response.deleteCommoditySuccess")),g(s.current)})}function $(i){p.value=a("commodity.formTitle.editCommodity"),m.value=i,r.value=!0}function q(i){m.value=i,d.value=!0}function P(i){e==null||e.emit("fullScreenLoading:show"),ee({...i,commodityBrand:m.value.brand,commodityId:m.value.id}).then(o=>{d.value=!1,e==null||e.emit("fullScreenLoading:hide"),C.info(a("commodity.response.generateNoteInfo")),R(JSON.parse(JSON.stringify(m.value)),o.data.id)})}return(i,o)=>{const u=oe;return v(),h(_,null,[f("section",ie,[f("section",ne,[f("span",null,S(t(a)("commodity.title")),1)]),l(t(k),{onChange:B,placeholder:t(a)("commodity.searchPlaceHolder"),filterConditionList:b.value},null,8,["placeholder","filterConditionList"]),f("section",ae,[z(l(t(E),{"blur-bg":!0},null,512),[[K,t(N)]]),(v(!0),h(_,null,A(t(L),n=>(v(),Q(t(I),{key:JSON.stringify(n),"commodity-info":n,onCreateNote:q,onEditCommodity:$,onDeleteCommodity:T},null,8,["commodity-info"]))),128))]),l(t(V),{"current-page":t(s).current,"onUpdate:currentPage":o[0]||(o[0]=n=>t(s).current=n),total:t(w)},{left:y(()=>[l(t(O),{onClick:F},{default:y(()=>[l(t(J),{name:"plus"}),f("span",null,S(t(a)("commodity.createCommodityBtn")),1)]),_:1})]),_:1},8,["current-page","total"])]),l(u,{visible:r.value,footer:!1,placement:"right",unmountOnClose:"",title:p.value,onCancel:o[2]||(o[2]=n=>r.value=!1)},{default:y(()=>[l(t(D),{"current-commodity":m.value,onSubmit:x,onCancel:o[1]||(o[1]=n=>r.value=!1)},null,8,["current-commodity"])]),_:1},8,["visible","title"]),l(u,{visible:d.value,footer:!1,placement:"right",unmountOnClose:"",title:t(a)("commodity.formTitle.generateNote"),onCancel:o[4]||(o[4]=n=>d.value=!1)},{default:y(()=>[l(t(G),{"commodity-info":m.value,onSubmit:P,onCancel:o[3]||(o[3]=n=>d.value=!1)},null,8,["commodity-info"])]),_:1},8,["visible","title"])],64)}}}),Ce=M(se,[["__scopeId","data-v-4abcdb6e"]]);export{Ce as default};
